% NOTE: create arxiv.tex and uncomment the following line
% \def\inarxiv{}
\documentclass[11pt,letterpaper,twocolumn]{article}

% conference specific style
\usepackage[11pt,nocopyright]{sigmin}
\usepackage[square,comma,numbers,sort&compress]{natbib}

% \pagestyle{plain}
% \pagestyle{empty}

% common packages
\input{pkgs}

\newcommand{\sys}{\mbox{\textsc{Die}}\xspace}

% ref. http://en.wikibooks.org/wiki/LaTeX/Colors
\newcommand{\TK}[1]{\noindent{\color{LimeGreen} {\bf \fbox{TK:}} #1}}
\newcommand{\YF}[1]{\noindent{\color{blue} {\bf \fbox{YF:}} #1}}

\newcommand{\XX}[0]{\textcolor{red}{XXX}}
\newcommand{\XXX}[1]{\textcolor{red}{XXX: #1}}
\newif\ifrev
\ifdefined\inrev
  \revtrue
  \usepackage[
  draft,
  commandnameprefix=ifneeded,
  authormarkup=none,
  commentmarkup=margin]{changes}
  \newcommand{\rev}[1]{\textcolor{blue}{#1}}
  \newcommand{\revd}[1]{\textcolor{red}{\sout{#1}}}
  \newcommand{\revonly}[1]{\textcolor{blue}{#1}}
\else
  \revfalse
  \usepackage[final,commandnameprefix=ifneeded]{changes}
  \newcommand{\rev}[1]{#1}
  \newcommand{\revd}[1]{\ignorespaces}
  \newcommand{\revonly}[1]{\ignorespaces}
\fi

% NOTE: hide TODO with star form \TODO*
\NewDocumentCommand{\TODO}{s m}{%
  \IfBooleanTF{#1}{}{%
    \noindent{\color{Melon} {\bf \fbox{TODO:}} #2}%
  }%
}
\newcommand{\FIXME}[1]{\noindent{\color{red} {\bf \fbox{FIXME:}} #1}}
% Define a darker green
\definecolor{darkgreen}{RGB}{0,128,0}
\newcommand{\DONE}[1]{\noindent{\color{darkgreen} {\bf \fbox{DONE:}} #1}}
\newcommand{\NOTE}[1]{\noindent{\color{blue} {\bf \fbox{NOTE:}} #1}}
\newcommand{\REVNOTE}[1]{%
  \revonly{
    \noindent
    {\color{blue}\fbox{\parbox{\linewidth}{\bfseries NOTE: #1}}}%
  }
}

\input{cmds}
% To be compatible with Overleaf
\IfFileExists{rev.tex}{\input{rev}}{}

% \myexternaldocument{arxiv}

\newcounter{referencepage}
\setcounter{referencepage}{999999} % Set to a large number by default
% Set up page limit warning
\AtBeginDocument{%
  \let\oldthebibliography\thebibliography
  \renewcommand{\thebibliography}[1]{%
    \setcounter{referencepage}{\value{page}}%
    \oldthebibliography{#1}%
  }
}

\backgroundsetup{contents={}}

\newcommand{\maxmainpages}{11} % main pages limit (excluding references)
\newcommand{\ShowWarning}{%
  \ifthenelse{\value{page}>\maxmainpages\and \value{page}<\thereferencepage}{%
    \backgroundsetup{
      contents={%
        \begin{tikzpicture}[remember picture,overlay]
          \node[yshift=-0.5in] at (current page.north) {%
            \textcolor{red}{\Large\bfseries WARNING: Page limit is
            \maxmainpages~pages! It's now page \thepage .}%
          };
        \end{tikzpicture}%
      },
      angle=0,
      position={current page.north},
      scale=1,
      opacity=1
    }%
    \BgMaterial%
  }{}%
}

\AddEverypageHook{\ShowWarning}

\begin{document}

\input{hdr}
\date{}
\maketitle

\sloppy

\input{abstract}
\input{intro}
\input{overview}
\input{design}
\input{impl}
\input{eval}
\input{relwk}
\input{conclusion}
\input{ack}

% uncomment if you don't cite anything
%\nocite{*}

% % use with balance package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \balance
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% use multicol if you are using pygmentize package along with multicol package
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\onecolumn
\begin{multicols}{2}
 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\bibliographystyle{abbrvnat}
\footnotesize
\setlength{\bibsep}{3pt}
\bibliography{p,sslab,conf}

% for multicol
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\end{multicols}

% uncomment for appendix
% \input{appendix}

\end{document}
